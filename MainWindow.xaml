<Window x:Class="SoundRecorder.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:soundRecorder="clr-namespace:SoundRecorder"
        Title="ضبط صدا" Height="350" Width="400" FlowDirection="LeftToRight">
    <Window.Resources>
        <soundRecorder:LevelToBrushConverter x:Key="LevelToBrushConverter"/>
        <!-- Flat, borderless progress bar styles to make two halves look like a single bar -->
        <Style TargetType="ProgressBar" x:Key="AudioLevelMeterStyle">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Foreground">
                <Setter.Value>
                    <Binding RelativeSource="{RelativeSource Self}" Path="Value" Converter="{StaticResource LevelToBrushConverter}"/>
                </Setter.Value>
            </Setter>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ProgressBar">
                        <Grid SnapsToDevicePixels="True">
                            <Border x:Name="PART_Track" Background="{TemplateBinding Background}"/>
                            <Border x:Name="PART_Indicator" Background="{TemplateBinding Foreground}" HorizontalAlignment="Left"/>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Mirrored indicator: fills from right edge to left (for left half) -->
        <Style TargetType="ProgressBar" x:Key="AudioLevelMeterStyleRight">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Foreground">
                <Setter.Value>
                    <Binding RelativeSource="{RelativeSource Self}" Path="Value" Converter="{StaticResource LevelToBrushConverter}"/>
                </Setter.Value>
            </Setter>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ProgressBar">
                        <Grid SnapsToDevicePixels="True">
                            <Border x:Name="PART_Track" Background="{TemplateBinding Background}"/>
                            <Border x:Name="PART_Indicator" Background="{TemplateBinding Foreground}" HorizontalAlignment="Right"/>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
    <Grid Margin="10" FlowDirection="RightToLeft">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <Label Grid.Row="0" Grid.Column="0" Content="منبع ضبط:" Margin="5" HorizontalAlignment="Right"/>
        <ComboBox Grid.Row="0" Grid.Column="1" x:Name="SourceComboBox" Margin="5" FlowDirection="RightToLeft"/>

        <Label Grid.Row="1" Grid.Column="0" Content="دسته‌بندی:" Margin="5" HorizontalAlignment="Right"/>
        <ComboBox Grid.Row="1" Grid.Column="1" x:Name="CategoryComboBox" Margin="5" IsEditable="True" 
                  TextBoxBase.TextChanged="CategoryComboBox_TextChanged" FlowDirection="RightToLeft"/>

        <Label Grid.Row="2" Grid.Column="0" Content="نام خواننده:" Margin="5" HorizontalAlignment="Right"/>
        <ComboBox Grid.Row="2" Grid.Column="1" x:Name="SingerComboBox" Margin="5" IsEditable="True" 
                  SelectionChanged="SingerComboBox_SelectionChanged" TextBoxBase.TextChanged="SingerComboBox_TextChanged" FlowDirection="RightToLeft"/>

        <Label Grid.Row="3" Grid.Column="0" Content="نام فایل:" Margin="5" HorizontalAlignment="Right"/>
        <TextBox Grid.Row="3" Grid.Column="1" x:Name="FileNameTextBox" Margin="5" IsReadOnly="True" FlowDirection="RightToLeft"/>

        <StackPanel Grid.Row="4" Grid.ColumnSpan="2" Orientation="Horizontal" HorizontalAlignment="Center" Margin="10">
            <Button x:Name="StartButton" Content="شروع ضبط" Width="100" Margin="5" Click="StartButton_Click"/>
            <Button x:Name="StopButton" Content="توقف ضبط" Width="100" Margin="5" Click="StopButton_Click" IsEnabled="False"/>
        </StackPanel>

        <Grid Grid.Row="5" Grid.ColumnSpan="2" Margin="5">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <ProgressBar x:Name="AudioLevelMeter" Grid.Column="0" Margin="0" Minimum="0" Maximum="100" Height="20" Style="{StaticResource AudioLevelMeterStyleRight}"/>
            <ProgressBar x:Name="CenterRangeMeter" Grid.Column="1" Margin="0" Minimum="0" Maximum="100" Height="20" Style="{StaticResource AudioLevelMeterStyle}"/>
        </Grid>
    </Grid>
</Window>